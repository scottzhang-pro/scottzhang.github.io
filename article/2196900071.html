<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.png" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"scottzhang.pro","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Do complex things with just a few keystrokes!">
<meta property="og:type" content="article">
<meta property="og:title" content="Bash for Data Manipulation">
<meta property="og:url" content="https://scottzhang.pro/article/2196900071.html">
<meta property="og:site_name" content="Scott&#39;s Blog">
<meta property="og:description" content="Do complex things with just a few keystrokes!">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-02-25T15:20:39.000Z">
<meta property="article:modified_time" content="2021-11-27T08:44:10.416Z">
<meta property="article:author" content="Scott">
<meta property="article:tag" content="bash">
<meta property="article:tag" content="linux">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://scottzhang.pro/article/2196900071.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Bash for Data Manipulation | Scott's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Scott's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Scott's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">学则不固, 知则不惑</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://scottzhang.pro/article/2196900071.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/instagram_profile_image.png">
      <meta itemprop="name" content="Scott">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Scott's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Bash for Data Manipulation
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-25 23:20:39" itemprop="dateCreated datePublished" datetime="2021-02-25T23:20:39+08:00">2021-02-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-11-27 16:44:10" itemprop="dateModified" datetime="2021-11-27T16:44:10+08:00">2021-11-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%B7%A5%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">数据工程</span></a>
                </span>
            </span>

          
            <span id="/article/2196900071.html" class="post-meta-item leancloud_visitors" data-flag-title="Bash for Data Manipulation" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/article/2196900071.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/article/2196900071.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>Do complex things with just a few keystrokes!</p>
</blockquote>
<span id="more"></span>
<p>Bash is a Unix shell and command language, it survived and thrived for almost 50 years because it lets people do complex things with just a few keystrokes. Sometimes called "the universal glue of programming," it helps users combine existing programs in new ways, automate repetitive tasks, and run programs on clusters and clouds that may be halfway around the world.</p>
<h1 id="basic">Basic</h1>
<blockquote>
<p>How to move around in the shell, and how to create, modify, and delete files and folders.</p>
</blockquote>
<ul>
<li><code>pwd</code> print working directory</li>
<li><code>ls</code>: listing files or directories</li>
<li><code>cd</code>: change directory</li>
<li><code>cp</code>: copy</li>
<li><code>mv</code>: move or rename</li>
<li><code>rm</code>: remove</li>
<li><code>$1</code> or <code>$2</code> in bash script file, receive ARGV in bash scripts. <code>$@</code> , <code>$*</code> means get ARGV list, <code>$#</code> means get ARGV length.</li>
</ul>
<h1 id="find-files">Find files</h1>
<h2 id="by-name">by name</h2>
<ul>
<li>find ., list all file and folder below current</li>
<li>find folder</li>
<li>find . -type d, find all foldre, no file</li>
<li>find . -type f, find all file , no foldre</li>
<li>find . -type f -name "test.txt", name as text txt file</li>
<li>find . -type f -name "text*", name as txt all file</li>
<li>find . -type f -iname "text*", 不区分大小写</li>
<li>find . -type f -name "*.py"</li>
</ul>
<h2 id="by-time">by time</h2>
<ul>
<li>find . -type f -mmin -10,过去十分钟修改过的文件</li>
<li>find . -type f -mmin +10</li>
<li>find . -type f -mmin +1 -mmin -5</li>
<li>find . -type f -mtime -20</li>
</ul>
<p>amin,atime: access min and access day; cmin,ctime: change min and change day; mmin,mtime: modify;</p>
<h2 id="by-size">by size</h2>
<ul>
<li>find . -size +5m, k,g is work too</li>
<li>ls -lah ./folders, info about sub folder and files,including size</li>
<li>find . -empty</li>
</ul>
<h2 id="by-permission">by permission</h2>
<ul>
<li>find. -perm 777, read, write, and excute</li>
<li>find folder -exec chown coreschafer:www-data {} +</li>
<li>find folder, will return all folder, -exec will run the command in that results, {} palceholder, + end of the command.</li>
<li>find folder -type f -exec chmod 664 {} +</li>
<li>find folder -perm 664</li>
<li>find . -type f -name "*.jpg"</li>
<li>find . -type f -name "*.jpg" -maxdepth 1, searched 1 level down</li>
<li>find . -type f -name "*.jpg" -maxdepth 1 -exec rm {} +, delete serched files</li>
</ul>
<h1 id="grep">Grep</h1>
<h2 id="grep-single-file">Grep single file</h2>
<blockquote>
<p>searched text</p>
</blockquote>
<ul>
<li>grep "text_you_want_search" filename.txt</li>
<li>grep -w "text_you_want_search" filename.txt, have to match all words</li>
<li>grep -wi "text_you_want_search" filename.txt, igore the lowcase and uppearcse.</li>
<li>grep -win "text_you_want_search" filename.txt, get info about the line number</li>
<li>grep -win -B 4 "text_you_want_search" filename.txt, return the context about the searched words, 4 line, behind</li>
<li>grep -win -A 4 "text_you_want_search" filename.txt, return the context about the searched words, 4 line, ahead</li>
<li>grep -win -C 4 "text_you_want_search" filename.txt, return the context about the searched words, 4 line, two line before and two behind.</li>
</ul>
<h2 id="grep-multi-file">Grep multi file</h2>
<ul>
<li>grep -win "text_" ./*, all file</li>
<li>grep -win "text_" ./*.txt, txt file</li>
<li>grep -winr "text" ./ , search all subdir</li>
<li>grep -wirl "text" ./ , no need match info, just file list</li>
<li>grep -wirc "text" ./ , show matched number in eatch file</li>
</ul>
<h2 id="grep-command-history">Grep command history</h2>
<ul>
<li>history | grep "git commit"</li>
<li>history | grep "git commit" | grep "dotfile"</li>
</ul>
<h2 id="grep-rgx">Grep rgx</h2>
<ul>
<li>grep -P "--" file.txt, work well in linux, mac need to config, I configed</li>
</ul>
<h1 id="curl">cURL</h1>
<h2 id="requests">Requests</h2>
<ul>
<li>curl url</li>
<li>curl http://localhost:5000</li>
<li>curl http:www.wittyfans.com/json_file</li>
<li>curl -i http:www.wittyfans.com/json_file, details info about the get</li>
<li>curl http:www.wittyfans.com/method</li>
<li>curl -d "first=name&amp;last=lastname" http:www.wittyfans.com/method, d for data, Post request</li>
<li>curl -X PUT -d "first=name&amp;last=lastname" http:www.wittyfans.com/method, d for data, Pust request</li>
<li>curl -X DELETE http:www.wittyfans.com/method, delete request</li>
</ul>
<h2 id="verify">Verify</h2>
<p>Could not verify your access ?</p>
<p><code>curl -u username:password http://wittyfans.com, Auth</code></p>
<h2 id="download">Download</h2>
<ul>
<li>curl http://wittyfans.com/folder, return binary file , error</li>
<li>curl -o filename.jpg http://wittyfans.com/folder , sucess</li>
<li>curl -o file_name.json http:/.api.wittyfans.com , Saving large json file</li>
</ul>
<h1 id="rsync">rsync</h1>
<h2 id="install">Install</h2>
<p>aviable in Mac, debian-based linux need to install</p>
<ul>
<li>apt-get install rsync</li>
<li>yum install rsync</li>
</ul>
<h2 id="use">Use</h2>
<ul>
<li>rsync folder1/* backup/ , sync fils to backup folder,will skping the subfolder's file, but affected subfolder</li>
<li>rsync -r folder1/* backup/ , including subfolder's file</li>
<li>rsync -r folder1 backup/, sync folder, not content in it</li>
</ul>
<h2 id="check-chage-before-run">Check chage before run</h2>
<ul>
<li>rsync -a --dry-run folder1/* backup/, check before the command run, now view showed</li>
<li>rsync -av --dry-run folder1/* backup/, auto view</li>
</ul>
<h2 id="source_folder-has-new-file">Source_folder has new file</h2>
<ul>
<li>rsync -av --delete --dry-run original/ backup/, check, be careful !</li>
</ul>
<h2 id="do-it-in-local-and-host">Do it in local and host</h2>
<ul>
<li>rsync -zaP -p local_folder username@ip:~/public/, z for compress, a for all, P for tarnsfer in internet</li>
<li>rsync 0zaP username@ip:~/public/file ~/Downloads/, revers</li>
</ul>
<h1 id="manipulating-data">Manipulating data</h1>
<blockquote>
<p>How to work with the data in those files</p>
</blockquote>
<p><code>cat</code>: view a files contents, meaning concatenate</p>
<p><code>less</code> &amp; <code>more</code>: view contents piece by piece, <code>more</code> is superseded by <code>less</code> now, In <code>less</code>:</p>
<ul>
<li><code>:n</code>, Move to next file</li>
<li><code>:p</code>, Go back to previous file</li>
<li><code>:q</code>, quit</li>
</ul>
<p><code>head</code>: look at the start of a text file, <code>head -3</code>, only display the first three lines</p>
<p><code>tail</code>: look at the end of a text file, <code>tail -n +7</code>, display content from line 7 to end</p>
<p><code>ls</code> : list everything below a directory, <code>ls -R -F</code>, <code>-R</code> recursive <code>-F</code>prints a <code>/</code> after the name of every directory and a <code>*</code> after the name of every runnable program.</p>
<p><code>man</code>: manual, automatically invokes <code>less</code></p>
<p><code>cut -f 2-5,8 -d values.csv</code>: select columns 2 through 5 and columns 8, using comma as the separator. <code>-d</code> means delimiter, <code>-f</code> meaning fields to specify columns</p>
<p><code>!command</code>: re-run the most recent use of that command matched</p>
<p><code>grep bicuspid seasonal/winter.csv</code>: prints lines from winter.csv that contain "bicuspid"</p>
<p><code>cat two_cities.txt | egrep 'Sydney Carton|Charles Darnay' | wc -l</code> : Count the number of lines in the book that contain <em>either</em> the character 'Sydney Carton' or 'Charles Darnay'.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-c: <span class="built_in">print</span> a count of matching lines rather than the lines themselves</span><br><span class="line">-h: <span class="keyword">do</span> not <span class="built_in">print</span> the names of files when searching multiple files</span><br><span class="line">-i: ignore <span class="keyword">case</span> (e.g., treat <span class="string">&quot;Regression&quot;</span> and <span class="string">&quot;regression&quot;</span> as matches)</span><br><span class="line">-l: <span class="built_in">print</span> the names of files that contain matches, not the matches</span><br><span class="line">-n: <span class="built_in">print</span> line numbers <span class="keyword">for</span> matching lines</span><br><span class="line">-v: invert the match, i.e., only show lines that don<span class="string">&#x27;t match</span></span><br><span class="line"><span class="string">egrep: grep -E</span></span><br></pre></td></tr></table></figure>
<h2 id="combining-tools">Combining tools</h2>
<blockquote>
<p>How to use this power to select the data you want, and introduce commands for sorting values and removing duplicates.</p>
</blockquote>
<p><code>head -n 5 seasonal/summer.csv &gt; top.csv</code>: get first 5 rows content of summer.csv, write to top.csv</p>
<p><code>cut -d , -f 2 seasonal/summer.csv | grep -v Tooth</code>, select all of the tooth names from column 2 of the comma delimited file.</p>
<p><code>wc</code>, word count, count a date from a file. <code>grep 2017-07 seasonal/spring.csv | wc -l</code></p>
<p><code>head -n 3 seasonal/s*</code>, show all s* files first 3 rows.</p>
<ul>
<li><code>*</code>, all</li>
<li><code>?</code>, single word</li>
<li><code>[...]</code> matches any one of the characters inside the square brackets, <code>201[78].txt</code> matches <code>2017.txt</code> or <code>2018.txt</code>, but not <code>2016.txt</code></li>
<li><code>&#123;...&#125;</code> matches any of the comma-separated patterns inside the curly brackets, so <code>&#123;*.txt, *.csv&#125;</code> matches any file whose name ends with <code>.txt</code> or <code>.csv</code>, but not files whose names end with <code>.pdf</code>.</li>
</ul>
<p><code>sort</code>, <code>-n</code>: sort numerically, <code>-r</code>: reverse, <code>-b</code>: ignore leading blanks, <code>-f</code>: be case-insensitive</p>
<p><code>uniq</code>, remove <strong>adjacent</strong> duplicated lines .</p>
<p><code>wc -l seasonal/*.csv</code>, Print line numbers for each file in folder seasonal</p>
<p><code>wc -l seasonal/*.csv | grep -v 'total' | sort -n | head -n 1</code>, remove rows with word 'total' and select first row.</p>
<h2 id="batch-processing">Batch processing</h2>
<blockquote>
<p>How to make your own pipelines do that. Along the way, you will see how the shell uses variables to store information.</p>
</blockquote>
<p><code>set</code>: check <strong>environment variables</strong></p>
<p><code>echo</code>: print</p>
<ul>
<li><code>$User</code>, user name</li>
<li><code>$OSTYPE</code> name of the kind of operating system you are using</li>
</ul>
<p><code>training=seasonal/summer.csv</code> then <code>echo $training</code>, define a variable and print it.</p>
<p><strong>For loop:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example 1</span></span><br><span class="line"><span class="keyword">for</span> filetype <span class="keyword">in</span> gif jpg png; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$filetype</span>; <span class="keyword">done</span></span><br><span class="line"><span class="comment"># Example 2</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> seasonal/*.csv; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$filename</span>; <span class="keyword">done</span></span><br><span class="line"><span class="comment"># Example 3</span></span><br><span class="line">datasets=seasonal/*.csv</span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> <span class="variable">$datasets</span>; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$filename</span>; <span class="keyword">done</span></span><br><span class="line"><span class="comment"># Example 4</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> seasonal/*.csv; <span class="keyword">do</span> head -n 2 <span class="variable">$file</span> | tail -n 1; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Do not using space in file name, it will causing issue in bash.</p>
</blockquote>
<h2 id="creating-new-tools">Creating new tools</h2>
<blockquote>
<p>How to go one step further and create new commands of your own.</p>
</blockquote>
<p><strong>Edit file using <code>nano</code>:</strong></p>
<p><code>nano filename.txt</code>, edit a file</p>
<ul>
<li><code>Ctrl</code> + <code>K</code>: delete a line.</li>
<li><code>Ctrl</code> + <code>U</code>: un-delete a line.</li>
<li><code>Ctrl</code> + <code>O</code>: save the file ('O' stands for 'output'). <em>You will also need to press Enter to confirm the filename!</em></li>
<li><code>Ctrl</code> + <code>X</code>: exit the editor.</li>
</ul>
<p><code>grep -h -v Tooth spring.csv summer.csv &gt; temp.csv</code>, <code>-h</code> stop it from printing filenames, <code>-v</code> printing all rows exclude Tooth</p>
<p><code>history | tail -n 3</code>, Show most recent 3 commands</p>
<p><code>$@</code>, pass filenames to scripts. <code>tail -q -n +2 $@ | wc -l</code></p>
<h2 id="downloading-data">Downloading data</h2>
<blockquote>
<p>how to download data files from web servers via the command line</p>
</blockquote>
<p><code>curl</code>, Client for URLs. <code>man curl</code> , check curl installation.</p>
<ul>
<li><code>curl -O url</code> save the file with it's original name</li>
<li><code>curl -o newname.txt url</code> new file name</li>
<li>Download all 100 data file, <code>curl -O https://s3.amazonaws.com/datafile[001-100].txt</code></li>
</ul>
<p><code>Wget</code>, World Wide Web and get. better than curl when downloading multiple files recursively. <code>which wget</code>, check <code>wget</code> installation.</p>
<p><code>wget -c -b https://wittyfans.com/201812SpotifyData.zip</code></p>
<ul>
<li><code>-c</code>, resume broken download</li>
<li><code>-b</code>, go to background</li>
<li><code>wget --wait=1 -i url_list.txt</code>, # Create a mandatory 1 second pause between downloading all files in url_list.txt</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use curl, download and rename a single file from URL</span></span><br><span class="line">curl -O Spotify201812.zip -L https://assets.datacamp.com/production/repositories/4180/datasets/eb1d6a36fa3039e4e00064797e1a1600d267b135/201812SpotifyData.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># Unzip, delete, then re-name to Spotify201812.csv</span></span><br><span class="line">unzip Spotify201812.zip &amp;&amp; rm Spotify201812.zip</span><br><span class="line">mv 201812SpotifyData.csv Spotify201812.csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># View url_list.txt to verify content</span></span><br><span class="line">cat url_list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use Wget, limit the download rate to 2500 KB/s, download all files in url_list.txt</span></span><br><span class="line">wget --limit-rate=2500k -i url_list.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Take a look at all files downloaded</span></span><br><span class="line">ls</span><br></pre></td></tr></table></figure>
<h2 id="csv-kit">CSV Kit</h2>
<blockquote>
<p>Using <code>csvkit</code> to convert, preview, filter and manipulate files to prepare our data for further analyses.</p>
</blockquote>
<p><code>pip install csvk</code> for install, <a target="_blank" rel="noopener" href="https://csvkit.readthedocs.io/en/latest/tutorial.html">Doc</a></p>
<h3 id="in2csv">in2csv</h3>
<ul>
<li><code>in2csv -h</code>, converting files to csv.</li>
<li><code>in2csv SpotifyData.xlsx &gt; SpotifyData.csv</code></li>
<li><code>in2csv SpotifyData.xlsx --sheet "Worksheet1_Popularity" &gt; Spotify_Popularity.csv</code>, Only converting a sheet</li>
</ul>
<h3 id="csvlook">csvlook</h3>
<ul>
<li><code>csvlook -h</code>, data preview on the command line.</li>
<li><code>csvlook SpotifyData.csv</code></li>
</ul>
<h3 id="csvsort">csvsort</h3>
<ul>
<li><code>csvsort -c 2 Spotify_Popularity.csv | csvlook</code></li>
</ul>
<h3 id="csvstat">csvstat</h3>
<ul>
<li><code>csvstat Spotify_Popularity.csv</code>, summary statistics</li>
</ul>
<h3 id="csvcut">csvcut</h3>
<ul>
<li><code>csvcut -n Spotify_MusicAttributes.csv</code>, Print a list of column headers in data file</li>
<li><code>csvcut -c 1,3,5 Spotify_MusicAttributes.csv</code>, Print the first column, by position</li>
<li><code>csvcut -c "track_id","duration_ms","loudness" Spotify_MusicAttributes.csv</code>, Print the track id, song duration, and loudness, by name</li>
</ul>
<h3 id="csvgrep">csvgrep</h3>
<ul>
<li><code>csvgrep -c "danceability" -m 0.812 Spotify_MusicAttributes.csv</code>, filter row danceability by value 0.812, column name must with "".</li>
</ul>
<h3 id="csvstack">csvstack</h3>
<ul>
<li><code>csvstack</code>, merge files.</li>
<li><code>csvstack Spotify_Rank6.csv Spotify_Rank7.csv &gt; Spotify.csv</code>, merge two files to one</li>
<li><code>csvstack -g "Rank6","Rank7" \ Spotify_Rank6.csv Spotify_Rank7.csv &gt; Spotify_Al</code>, merge two files to one and add a source column.</li>
</ul>
<h3 id="chain-commands">chain commands</h3>
<ul>
<li><code>;</code>, links commands together and runs sequentially</li>
<li><code>&amp;&amp;</code>, links commands together, but only runs the 2nd command if the 1st succeeds</li>
<li><code>&gt;</code>, using outputs from the 1st command</li>
<li><code>|</code>, using outputs form the 1st as input to the 2nd</li>
</ul>
<h3 id="sql2csv">sql2csv</h3>
<ul>
<li><code>sql2csv -v</code> or <code>sql2csv --verbose</code>, printing more tracebacks and logs</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pull the entire Spotify_Popularity table and print in log</span></span><br><span class="line">sql2csv --db <span class="string">&quot;sqlite:///SpotifyDatabase.db&quot;</span> \</span><br><span class="line">        --query <span class="string">&quot;SELECT * FROM Spotify_Popularity&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="csvsql">csvsql</h3>
<p>Manipulating data using SQL syntax (Small to medium files only) :</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Reformat the output using csvlook</span></span><br><span class="line">csvsql --query <span class="string">&quot;SELECT * FROM Spotify_MusicAttributes ORDER BY duration_ms LIMIT 1&quot;</span> \</span><br><span class="line">	Spotify_MusicAttributes.csv | csvlook</span><br></pre></td></tr></table></figure>
<p>using bash variable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Store SQL query as shell variable</span></span><br><span class="line">sqlquery=<span class="string">&quot;SELECT * FROM Spotify_MusicAttributes ORDER BY duration_ms LIMIT 1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Apply SQL query to Spotify_MusicAttributes.csv</span></span><br><span class="line">csvsql --query <span class="string">&quot;<span class="variable">$sqlquery</span>&quot;</span> Spotify_MusicAttributes.csv</span><br></pre></td></tr></table></figure>
<p>join two file:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Store SQL query as shell variable</span></span><br><span class="line">sql_query=<span class="string">&quot;SELECT ma.*, p.popularity FROM Spotify_MusicAttributes ma INNER JOIN Spotify_Popularity p ON ma.track_id = p.track_id&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Join 2 local csvs into a new csv using the saved SQL</span></span><br><span class="line">csvsql --query <span class="string">&quot;<span class="variable">$sql_query</span>&quot;</span> Spotify_MusicAttributes.csv Spotify_Popularity.csv &gt; Spotify_FullData.csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># Preview newly created file</span></span><br><span class="line">csvstat Spotify_FullData.csv</span><br></pre></td></tr></table></figure>
<p>Pushing data back to database:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Store SQL for querying from SQLite database</span></span><br><span class="line">sqlquery_pull=<span class="string">&quot;SELECT * FROM SpotifyMostRecentData&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Apply SQL to save table as local file</span></span><br><span class="line">sql2csv --db <span class="string">&quot;sqlite:///SpotifyDatabase.db&quot;</span> --query <span class="string">&quot;<span class="variable">$sqlquery_pull</span>&quot;</span> &gt; SpotifyMostRecentData.csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># Store SQL for UNION of the two local CSV files</span></span><br><span class="line">sqlquery_union=<span class="string">&quot;SELECT * FROM SpotifyMostRecentData UNION ALL SELECT * FROM Spotify201812&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Apply SQL to union the two local CSV files and save as local file</span></span><br><span class="line">csvsql 	--query <span class="string">&quot;<span class="variable">$sqlquery_union</span>&quot;</span> SpotifyMostRecentData.csv Spotify201812.csv &gt; UnionedSpotifyData.csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># Push UnionedSpotifyData.csv to database as a new table</span></span><br><span class="line">csvsql --db <span class="string">&quot;sqlite:///SpotifyDatabase.db&quot;</span> --insert UnionedSpotifyData.csv</span><br></pre></td></tr></table></figure>
<h1 id="bash-script">Bash Script</h1>
<h2 id="stream-editor">Stream editor</h2>
<p><code>sed</code>: stream editor.</p>
<p><code>cat soccer_scores.csv | sed 's/Cherno/Cherno City/g' &gt; soccer_scores_edited.csv</code> : replace word <code>Cherno</code> to <code>herno City</code> then save it to a new file, for more, check <a target="_blank" rel="noopener" href="https://coolshell.cn/articles/9104.html">this</a>.</p>
<h2 id="argument">Argument</h2>
<p><code>$1</code> or <code>$2</code> in bash script file, receive ARGV in bash scripts. <code>$@</code> , <code>$*</code> means get ARGV list, <code>$#</code> means get ARGV length. <code>cat hire_data/*.csv | grep "$1" &gt; "$1".csv</code>: take in a city (an argument) as a variable, filter all the files by this city and output to a new CSV with the city name.</p>
<h2 id="quotes">Quotes</h2>
<p>Single,double,backticks.</p>
<ul>
<li>Single quotes ('sometext') = Shell interprets what is between literally</li>
<li>Double quotes ("sometext") = Shell interpret literally except using $ and backticks</li>
<li>Backticks (`sometext`) = Shell runs the command and captures STDOUT back into a variable</li>
</ul>
<h2 id="numeric-variables">Numeric variables</h2>
<p>In bash, Type <code>&gt;&gt;&gt; 1 + 5</code> will get error. instead, you need type <code>expr 1 + 5</code>. <code>expr</code> is utility program just like <code>cat</code> and <code>grep</code>. but <code>expr</code> cannot natively handle decimal places. <code>expr 1 + 2.5</code> will get <code>not a decimal nuber error</code>.</p>
<p>Introduce <code>bc</code> (basic calculator), a useful command-line program. using <code>bc</code> without opening the calculator:</p>
<p><code>echo "5+7.5" | bc</code> , <code>bc</code> has a <code>scale</code> argument for how many decimal places: <code>echo "scale=3; 10 /3 | bc"</code>, <code>;</code> is to separate lines in terminal.</p>
<h2 id="array">Array</h2>
<h3 id="normal-array">Normal array</h3>
<p>Create array: <code>capital_cities=("Sydney" "New York" "Paris")</code></p>
<p>Add element:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a normal array with the mentioned elements using the declare method</span></span><br><span class="line"><span class="built_in">declare</span> -a capital_cities</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add (append) the elements</span></span><br><span class="line">capital_cities+=(<span class="string">&quot;Sydney&quot;</span>)</span><br><span class="line">capital_cities+=(<span class="string">&quot;New York&quot;</span>)</span><br><span class="line">capital_cities+=(<span class="string">&quot;Paris&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>Get all element and length of array:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The array has been created for you</span></span><br><span class="line">capital_cities=(<span class="string">&quot;Sydney&quot;</span> <span class="string">&quot;New York&quot;</span> <span class="string">&quot;Paris&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print out the entire array</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;capital_cities[@]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print out the array length</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#capital_cities[@]&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="associative-arrays">Associative arrays</h3>
<blockquote>
<p>Like dictionary in python.</p>
</blockquote>
<p>Create:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create empty associative array</span></span><br><span class="line"><span class="built_in">declare</span> -A model_metrics</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add the key-value pairs</span></span><br><span class="line">model_metrics[model_accuracy]=98</span><br><span class="line">model_metrics[model_name]=<span class="string">&quot;knn&quot;</span></span><br><span class="line">model_metrics[model_f1]=0.82</span><br></pre></td></tr></table></figure>
<p>Create in one line:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># An associative array has been created for you</span></span><br><span class="line"><span class="built_in">declare</span> -A model_metrics=([model_accuracy]=98 [model_name]=<span class="string">&quot;knn&quot;</span> [model_f1]=0.82)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print out just the keys</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;____model_metrics[____]&#125;</span></span><br></pre></td></tr></table></figure>
<p>Example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create variables from the temperature data files</span></span><br><span class="line">temp_b=<span class="string">&quot;<span class="subst">$(cat temps/region_B)</span>&quot;</span></span><br><span class="line">temp_c=<span class="string">&quot;<span class="subst">$(cat temps/region_C)</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an array with these variables as elements</span></span><br><span class="line">region_temps=(<span class="variable">$temp_b</span> <span class="variable">$temp_c</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Call an external program to get average temperature</span></span><br><span class="line">average_temp=$(<span class="built_in">echo</span> <span class="string">&quot;scale=2; (<span class="variable">$&#123;region_temps[0]&#125;</span> + <span class="variable">$&#123;region_temps[1]&#125;</span>) / 2&quot;</span> | bc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Append to array</span></span><br><span class="line">region_temps+=(<span class="variable">$average_temp</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print out the whole array</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;region_temps[@]&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="control-statements">Control Statements</h2>
<h3 id="if-statements">IF statements</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition1 ] &amp;&amp; [ condition2 ]; <span class="keyword">then</span></span><br><span class="line">	<span class="comment"># some code</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="comment"># some code</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>Move files based on content:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Extract Accuracy from first ARGV element</span></span><br><span class="line">accuracy=$(grep Accuracy <span class="variable">$1</span> | sed <span class="string">&#x27;s/.* //&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Conditionally move into good_models folder</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$accuracy</span> -ge 90 ]; <span class="keyword">then</span></span><br><span class="line">    mv <span class="variable">$1</span> ./good_models</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Conditionally move into bad_models folder</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$accuracy</span> -lt 90 ]; <span class="keyword">then</span></span><br><span class="line">    mv <span class="variable">$1</span> ./bad_models</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Normal flags</span></span><br><span class="line">-eq =</span><br><span class="line">-ne !=</span><br><span class="line">-lt &lt;</span><br><span class="line">-le &lt;=</span><br><span class="line">-gt &gt;</span><br><span class="line">-ge &gt;=</span><br><span class="line"></span><br><span class="line"><span class="comment"># File related flags</span></span><br><span class="line">-e <span class="keyword">if</span> the file exists</span><br><span class="line">-s <span class="keyword">if</span> the file exists and has size greater than zero</span><br><span class="line">-r <span class="keyword">if</span> the file exists and is readable</span><br><span class="line">-w <span class="keyword">if</span> the file exists and is writable</span><br><span class="line"></span><br><span class="line"><span class="comment">## And and OR</span></span><br><span class="line">&amp;&amp; <span class="keyword">for</span> and</span><br><span class="line">|| <span class="keyword">for</span> or</span><br></pre></td></tr></table></figure>
<h2 id="for-loops">For loops</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Use a FOR loop on files in directory</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> inherited_folder/*.R</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># Echo out each file</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$file</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Move python file to to_keep if it using random forest class fier</span></span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> robs_files/*.py</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="comment"># Create IF statement using grep</span></span><br><span class="line">    <span class="keyword">if</span> grep -q <span class="string">&#x27;RandomForestClassifier&#x27;</span> <span class="variable">$file</span> ; <span class="keyword">then</span></span><br><span class="line">        <span class="comment"># Move wanted files to to_keep/ folder</span></span><br><span class="line">        mv <span class="variable">$file</span> to_keep/</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h2 id="case">Case</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a CASE statement matching the first ARGV element</span></span><br><span class="line"><span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">  <span class="comment"># Match on all weekdays</span></span><br><span class="line">  Monday|Tuesday|Wednesday|Thursday|Friday)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;It is a Weekday!&quot;</span>;;</span><br><span class="line">  <span class="comment"># Match on all weekend days</span></span><br><span class="line">  Saturday|Sunday)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;It is a Weekend!&quot;</span>;;</span><br><span class="line">  <span class="comment"># Create a default</span></span><br><span class="line">  *)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Not a day!&quot;</span>;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>
<h2 id="function">Function</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> function_name &#123;</span><br><span class="line">	<span class="comment">#function_code</span></span><br><span class="line">	<span class="built_in">return</span> <span class="comment">#something</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">print_hello</span></span> () &#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello world!&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print_hello</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Scope: All variables in Bash are global by default!</strong>Using <code>local val</code> to restrict variable scope.</p>
</blockquote>
<p>To get data out from function:</p>
<ol type="1">
<li>Assign to a global variable</li>
<li><code>echo</code> what we want back in last line and capture using shell-within-shell</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> convert &#123;</span><br><span class="line">	<span class="built_in">echo</span> $(<span class="built_in">echo</span> <span class="variable">$1</span>)</span><br><span class="line">&#125;</span><br><span class="line">converted = $(convert 30)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a function with a local base variable</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">sum_array</span></span> () &#123;</span><br><span class="line">  <span class="built_in">local</span> sum=0</span><br><span class="line">  <span class="comment"># Loop through, adding to base variable</span></span><br><span class="line">  <span class="keyword">for</span> number <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    sum=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$sum</span> + <span class="variable">$number</span>&quot;</span> | bc)</span><br><span class="line">  <span class="keyword">done</span></span><br><span class="line">  <span class="comment"># Echo back the result</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$sum</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment"># Call function with array</span></span><br><span class="line">test_array=(14 12 23.5 16 19.34)</span><br><span class="line">total=$(sum_array <span class="string">&quot;<span class="variable">$&#123;test_array[@]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;The total sum of the test array is <span class="variable">$total</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="python-script-on-bash">Python script on bash</h1>
<blockquote>
<p>Scheduling a job with crontab</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Preview both Python script and requirements text file</span></span><br><span class="line">cat create_model.py</span><br><span class="line">cat requirements.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pip install Python dependencies in requirements file</span></span><br><span class="line">pip install -r requirements.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run Python script on command line</span></span><br><span class="line">python create_model.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add CRON job that runs create_model.py every minute</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;* * * * * python create_model.py&quot;</span> | crontab</span><br><span class="line"></span><br><span class="line"><span class="comment"># Verify that the CRON job has been scheduled via CRONTAB</span></span><br><span class="line">crontab -l</span><br></pre></td></tr></table></figure>
<h1 id="cron">Cron</h1>
<ul>
<li>crontab -l, list the crons</li>
</ul>
<blockquote>
<p>set your editor to nano, default vim</p>
</blockquote>
<ul>
<li>export EDITOR=/user/bin/nano</li>
<li>crontab -e, open editor</li>
<li>press i to input</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Algorhythm for schuel you task with time</span><br><span class="line"></span><br><span class="line"># ┌───────────── minute (0 - 59)</span><br><span class="line"># │ ┌───────────── hour (0 - 23)</span><br><span class="line"># │ │ ┌───────────── day of month (1 - 31)</span><br><span class="line"># │ │ │ ┌───────────── month (1 - 12)</span><br><span class="line"># │ │ │ │ ┌───────────── day of week (0 - 6) (Sunday to Saturday;</span><br><span class="line"># │ │ │ │ │                                       7 is also Sunday on some systems)</span><br><span class="line"># │ │ │ │ │</span><br><span class="line"># │ │ │ │ │</span><br><span class="line"># * * * * *  command_to_execute</span><br><span class="line"></span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/uploads/wechat-reward-image.png" alt="Scott 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/bash/" rel="tag"># bash</a>
              <a href="/tags/linux/" rel="tag"># linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/article/1775964342.html" rel="prev" title="机器学习相关概念解读P1">
      <i class="fa fa-chevron-left"></i> 机器学习相关概念解读P1
    </a></div>
      <div class="post-nav-item">
    <a href="/article/3170800033.html" rel="next" title="Spark 笔记">
      Spark 笔记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#basic"><span class="nav-number">1.</span> <span class="nav-text">Basic</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#find-files"><span class="nav-number">2.</span> <span class="nav-text">Find files</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#by-name"><span class="nav-number">2.1.</span> <span class="nav-text">by name</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#by-time"><span class="nav-number">2.2.</span> <span class="nav-text">by time</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#by-size"><span class="nav-number">2.3.</span> <span class="nav-text">by size</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#by-permission"><span class="nav-number">2.4.</span> <span class="nav-text">by permission</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#grep"><span class="nav-number">3.</span> <span class="nav-text">Grep</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#grep-single-file"><span class="nav-number">3.1.</span> <span class="nav-text">Grep single file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#grep-multi-file"><span class="nav-number">3.2.</span> <span class="nav-text">Grep multi file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#grep-command-history"><span class="nav-number">3.3.</span> <span class="nav-text">Grep command history</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#grep-rgx"><span class="nav-number">3.4.</span> <span class="nav-text">Grep rgx</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#curl"><span class="nav-number">4.</span> <span class="nav-text">cURL</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#requests"><span class="nav-number">4.1.</span> <span class="nav-text">Requests</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#verify"><span class="nav-number">4.2.</span> <span class="nav-text">Verify</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#download"><span class="nav-number">4.3.</span> <span class="nav-text">Download</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#rsync"><span class="nav-number">5.</span> <span class="nav-text">rsync</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#install"><span class="nav-number">5.1.</span> <span class="nav-text">Install</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#use"><span class="nav-number">5.2.</span> <span class="nav-text">Use</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#check-chage-before-run"><span class="nav-number">5.3.</span> <span class="nav-text">Check chage before run</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source_folder-has-new-file"><span class="nav-number">5.4.</span> <span class="nav-text">Source_folder has new file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#do-it-in-local-and-host"><span class="nav-number">5.5.</span> <span class="nav-text">Do it in local and host</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#manipulating-data"><span class="nav-number">6.</span> <span class="nav-text">Manipulating data</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#combining-tools"><span class="nav-number">6.1.</span> <span class="nav-text">Combining tools</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#batch-processing"><span class="nav-number">6.2.</span> <span class="nav-text">Batch processing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#creating-new-tools"><span class="nav-number">6.3.</span> <span class="nav-text">Creating new tools</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#downloading-data"><span class="nav-number">6.4.</span> <span class="nav-text">Downloading data</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#csv-kit"><span class="nav-number">6.5.</span> <span class="nav-text">CSV Kit</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#in2csv"><span class="nav-number">6.5.1.</span> <span class="nav-text">in2csv</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvlook"><span class="nav-number">6.5.2.</span> <span class="nav-text">csvlook</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvsort"><span class="nav-number">6.5.3.</span> <span class="nav-text">csvsort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvstat"><span class="nav-number">6.5.4.</span> <span class="nav-text">csvstat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvcut"><span class="nav-number">6.5.5.</span> <span class="nav-text">csvcut</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvgrep"><span class="nav-number">6.5.6.</span> <span class="nav-text">csvgrep</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvstack"><span class="nav-number">6.5.7.</span> <span class="nav-text">csvstack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#chain-commands"><span class="nav-number">6.5.8.</span> <span class="nav-text">chain commands</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sql2csv"><span class="nav-number">6.5.9.</span> <span class="nav-text">sql2csv</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#csvsql"><span class="nav-number">6.5.10.</span> <span class="nav-text">csvsql</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#bash-script"><span class="nav-number">7.</span> <span class="nav-text">Bash Script</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#stream-editor"><span class="nav-number">7.1.</span> <span class="nav-text">Stream editor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#argument"><span class="nav-number">7.2.</span> <span class="nav-text">Argument</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#quotes"><span class="nav-number">7.3.</span> <span class="nav-text">Quotes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#numeric-variables"><span class="nav-number">7.4.</span> <span class="nav-text">Numeric variables</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#array"><span class="nav-number">7.5.</span> <span class="nav-text">Array</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#normal-array"><span class="nav-number">7.5.1.</span> <span class="nav-text">Normal array</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#associative-arrays"><span class="nav-number">7.5.2.</span> <span class="nav-text">Associative arrays</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#control-statements"><span class="nav-number">7.6.</span> <span class="nav-text">Control Statements</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if-statements"><span class="nav-number">7.6.1.</span> <span class="nav-text">IF statements</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#for-loops"><span class="nav-number">7.7.</span> <span class="nav-text">For loops</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#case"><span class="nav-number">7.8.</span> <span class="nav-text">Case</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#function"><span class="nav-number">7.9.</span> <span class="nav-text">Function</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#python-script-on-bash"><span class="nav-number">8.</span> <span class="nav-text">Python script on bash</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cron"><span class="nav-number">9.</span> <span class="nav-text">Cron</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Scott"
      src="/uploads/instagram_profile_image.png">
  <p class="site-author-name" itemprop="name">Scott</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">63</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wittyfans" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wittyfans" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/wittyfans" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;wittyfans" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/wittyfans0" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;wittyfans0" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Scott</span>
</div>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              Counter('post', '/classes/Counter', { title, url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"7sScl0n1AlEtVDaUHuXzxPqc-gzGzoHsz","app_key":"qKXpoqGbK1sdFYMiik7Evuan","server_url":"https://7sscl0n1.lc-cn-n1-shared.com","security":false};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '7sScl0n1AlEtVDaUHuXzxPqc-gzGzoHsz',
      appKey     : 'qKXpoqGbK1sdFYMiik7Evuan',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
